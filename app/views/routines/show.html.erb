<div class="panel panel-default">
  <div class="panel-heading">
    <h3 class="panel-title">
      <%= @routine.title %>
    </h3>
    <small><em>a workout designed by <%= @routine.user.name %></em></small>
    <br>
    <p><span class="glyphicon glyphicon-time"></span> <strong>Duration</strong>: <%= @routine.duration %> minutes</p>
    <p><span class="glyphicon glyphicon-signal"></span> <strong>Difficulty Level</strong>: <%= @routine.difficulty_level %></p>
    <p><strong>Required Equipment</strong>: <%= display_equipment_for(@routine) %></p>
  </div>

  <div class="panel-body" id="workout-routine">
    <% @routine.movements.each do |movement| %>
      <div id="mr-<%= mr_instance(movement, @routine).id %>-div">
        <h5>Exercise: <%= link_to movement.name, movement_path(movement) %></h5>
      
        <button class="js-show-technique btn btn-default btn-sm" data-id="<%= mr_instance(movement, @routine).id %>">Show Technique</button>

        <br><br>

        <div id="technique-div-<%= mr_instance(movement, @routine).id %>"></div>

        <p id="sets-paragraph-<%= mr_instance(movement, @routine).id %>"><strong>Sets</strong>: <%= mr_instance(movement, @routine).sets %></p>

        <p id="reps-paragraph-<%= mr_instance(movement, @routine).id %>"><strong>Reps</strong>: <%= mr_instance(movement, @routine).reps %></p>

        <div id="edit-mr-<%= mr_instance(movement, @routine).id %>-div"></div>

        <% if policy(@routine).edit? %>
          <%= link_to "/mrs/#{mr_instance(movement, @routine).id}/edit", class: "edit-exercise btn btn-default btn-sm", data: { mr_id: "#{mr_instance(movement, @routine).id}" }  do
            content_tag(:span, nil, class: "glyphicon glyphicon-edit") + content_tag(:small, " Edit Exercise")
          end %>

          <%= button_to "/mrs/#{mr_instance(movement, @routine).id}", class: "btn btn-danger btn-sm", method: :delete, form: {style: 'display:inline-block;'}, data: { confirm: "Are you sure you want to remove this exercise?"} do %>
            <span class="glyphicon glyphicon-trash"></span> <small>Delete Exercise</small>
          <% end %>
          <br>
        <% end %>
        
        <%= content_tag(:hr) unless movement == @routine.movements.last %>
      </div>
    <% end %>
  </div>
</div>

<%= render partial: "add_exercise_form", locals: {routine: @routine} if policy(@routine).edit? %>

<br><br>

<% if policy(@routine).edit? %>
  <%= link_to edit_routine_path(@routine), class: 'btn btn-default btn-md edit-workout', data: {id: @routine.id} do
    content_tag(:span, nil, class: "glyphicon glyphicon-edit") + content_tag(:span, " Edit Workout")
  end %>
<% end %>

<% if policy(@routine).destroy? %>
  <%= button_to routine_path(@routine), class: "btn btn-danger btn-md delete-workout", method: :delete, form: {style: 'display:inline-block;'} do %>
    <span class="glyphicon glyphicon-trash"></span> <span>Delete Workout</span>
  <% end %>
<% end %>